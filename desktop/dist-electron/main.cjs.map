{
  "version": 3,
  "sources": ["../src/main/main.ts"],
  "sourcesContent": ["\r\nimport { app, BrowserWindow, ipcMain } from 'electron';\r\nimport path from 'node:path';\r\nimport activeWin from 'active-win';\r\n// main process creates window, runs monitoring loop, and handles IPC from renderer\r\nlet mainWindow: BrowserWindow | null = null;\r\n\r\ntype SessionState = {       // state of the current focus session\r\n  running: boolean;\r\n  blacklist: string[];\r\n  centsOwed: number;\r\n  feePerMin: number; // $/minute, e.g. 0.5\r\n  lastCheck: number;\r\n};\r\nconst state: SessionState = {       //initial state of session\r\n  running: false,\r\n  blacklist: ['youtube', 'twitter', 'instagram', 'steam'],\r\n  centsOwed: 0,\r\n  feePerMin: 0.5,\r\n  lastCheck: Date.now(),\r\n};\r\n\r\nasync function createWindow() {         //creates the desktop window and loads the React app\r\n  mainWindow = new BrowserWindow({\r\n    width: 1100,\r\n    height: 720,\r\n    webPreferences: {\r\n        preload: path.join(__dirname, 'preload.cjs'),\r\n        contextIsolation: true,\r\n        nodeIntegration: false,\r\n},\r\n\r\n \r\n\r\n\r\n  });\r\n\r\n  const isDev = !!process.env.VITE_DEV_SERVER;      // dev commands.  VITE_DEV_SERVER in development mode\r\n  if (isDev) {\r\n    await mainWindow.loadURL(process.env.VITE_DEV_SERVER_URL || 'http://localhost:5173');\r\n  } else {\r\n    await mainWindow.loadFile(path.join(__dirname, '../../dist/index.html'));\r\n  }\r\n\r\n  mainWindow.on('closed', () => {\r\n    mainWindow = null;\r\n  });\r\n}\r\n\r\napp.whenReady().then(createWindow);         //lifecycle events\r\napp.on('window-all-closed', () => {\r\n  if (process.platform !== 'darwin') app.quit();\r\n});\r\napp.on('activate', () => {                  //macOS behavior: re-create window when dock icon is clicked and no other windows are open\r\n  if (BrowserWindow.getAllWindows().length === 0) createWindow();\r\n});\r\n\r\n// Monitoring loop\r\nsetInterval(async () => {\r\n  if (!state.running || !mainWindow) return;\r\n  try {                             //checks active window title against blacklist every 1.5 seconds.\r\n    const win = await activeWin();\r\n    const title = (win?.title || '').toLowerCase();\r\n    const now = Date.now();\r\n    const elapsedMin = (now - state.lastCheck) / 60000;         // calculate elapsed time in minutes since last check\r\n    const distracted = state.blacklist.some(b => title.includes(b));\r\n\r\n    if (distracted) {                       //if offtask, update cents owed based on elapsed time and fee per minute\r\n      state.centsOwed += Math.ceil(elapsedMin * state.feePerMin * 100);\r\n    }\r\n    state.lastCheck = now;\r\n\r\n    mainWindow.webContents.send('tick', {           //send tick event to renderer with updated data\r\n      distracted,\r\n      centsOwed: state.centsOwed,\r\n      activeTitle: win?.title || '',\r\n    });\r\n  } catch (e) {\r\n    // swallow errors to keep loop alive\r\n  }\r\n}, 1500);\r\n\r\n// IPC handlers for control\r\nipcMain.handle('session:start', (_e, payload: { blacklist: string[]; feePerMin: number }) => {\r\n  state.blacklist = payload.blacklist.map(s => s.toLowerCase());\r\n  state.feePerMin = payload.feePerMin;\r\n  state.centsOwed = 0;\r\n  state.lastCheck = Date.now();\r\n  state.running = true;\r\n  return { ok: true };\r\n});\r\n\r\nipcMain.handle('session:stop', () => {      // stop session and return total cents owed\r\n  state.running = false;\r\n  return { centsOwed: state.centsOwed };\r\n});\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AACA,sBAA4C;AAC5C,uBAAiB;AACjB,wBAAsB;AAEtB,IAAI,aAAmC;AASvC,MAAM,QAAsB;AAAA;AAAA,EAC1B,SAAS;AAAA,EACT,WAAW,CAAC,WAAW,WAAW,aAAa,OAAO;AAAA,EACtD,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW,KAAK,IAAI;AACtB;AAEA,eAAe,eAAe;AAC5B,eAAa,IAAI,8BAAc;AAAA,IAC7B,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,gBAAgB;AAAA,MACZ,SAAS,iBAAAA,QAAK,KAAK,WAAW,aAAa;AAAA,MAC3C,kBAAkB;AAAA,MAClB,iBAAiB;AAAA,IACzB;AAAA,EAKE,CAAC;AAED,QAAM,QAAQ,CAAC,CAAC,QAAQ,IAAI;AAC5B,MAAI,OAAO;AACT,UAAM,WAAW,QAAQ,QAAQ,IAAI,uBAAuB,uBAAuB;AAAA,EACrF,OAAO;AACL,UAAM,WAAW,SAAS,iBAAAA,QAAK,KAAK,WAAW,uBAAuB,CAAC;AAAA,EACzE;AAEA,aAAW,GAAG,UAAU,MAAM;AAC5B,iBAAa;AAAA,EACf,CAAC;AACH;AAEA,oBAAI,UAAU,EAAE,KAAK,YAAY;AACjC,oBAAI,GAAG,qBAAqB,MAAM;AAChC,MAAI,QAAQ,aAAa,SAAU,qBAAI,KAAK;AAC9C,CAAC;AACD,oBAAI,GAAG,YAAY,MAAM;AACvB,MAAI,8BAAc,cAAc,EAAE,WAAW,EAAG,cAAa;AAC/D,CAAC;AAGD,YAAY,YAAY;AACtB,MAAI,CAAC,MAAM,WAAW,CAAC,WAAY;AACnC,MAAI;AACF,UAAM,MAAM,UAAM,kBAAAC,SAAU;AAC5B,UAAM,SAAS,KAAK,SAAS,IAAI,YAAY;AAC7C,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,cAAc,MAAM,MAAM,aAAa;AAC7C,UAAM,aAAa,MAAM,UAAU,KAAK,OAAK,MAAM,SAAS,CAAC,CAAC;AAE9D,QAAI,YAAY;AACd,YAAM,aAAa,KAAK,KAAK,aAAa,MAAM,YAAY,GAAG;AAAA,IACjE;AACA,UAAM,YAAY;AAElB,eAAW,YAAY,KAAK,QAAQ;AAAA;AAAA,MAClC;AAAA,MACA,WAAW,MAAM;AAAA,MACjB,aAAa,KAAK,SAAS;AAAA,IAC7B,CAAC;AAAA,EACH,SAAS,GAAG;AAAA,EAEZ;AACF,GAAG,IAAI;AAGP,wBAAQ,OAAO,iBAAiB,CAAC,IAAI,YAAwD;AAC3F,QAAM,YAAY,QAAQ,UAAU,IAAI,OAAK,EAAE,YAAY,CAAC;AAC5D,QAAM,YAAY,QAAQ;AAC1B,QAAM,YAAY;AAClB,QAAM,YAAY,KAAK,IAAI;AAC3B,QAAM,UAAU;AAChB,SAAO,EAAE,IAAI,KAAK;AACpB,CAAC;AAED,wBAAQ,OAAO,gBAAgB,MAAM;AACnC,QAAM,UAAU;AAChB,SAAO,EAAE,WAAW,MAAM,UAAU;AACtC,CAAC;",
  "names": ["path", "activeWin"]
}
